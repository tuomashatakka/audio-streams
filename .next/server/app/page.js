(()=>{var e={};e.id=974,e.ids=[974],e.modules={441:()=>{},597:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/tvndra/Documents/Projects/Audio/audioblocks/audio-streams/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/tvndra/Documents/Projects/Audio/audioblocks/audio-streams/app/page.tsx","default")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1131:(e,t,a)=>{Promise.resolve().then(a.bind(a,597))},1187:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var r=a(687),s=a(3210),i=function(e){return e.WAV="audio/wav",e.MP3="audio/mpeg",e.M4A="audio/mp4",e.OGG="audio/ogg",e.FLAC="audio/flac",e}({});let l=["#ff006e","#fb5607","#ffbe0b","#8ecae6","#219ebc","#023047","#3a86ff","#7209b7"];var n=function(e){return e.DECODE_AUDIO="decode_audio",e.AUDIO_DECODED="audio_decoded",e.DECODE_ERROR="decode_error",e.GENERATE_WAVEFORM="generate_waveform",e.WAVEFORM_GENERATED="waveform_generated",e}({});function o(e){return e.type.startsWith("audio/")||Object.values(i).includes(e.type)}function c(){return l[Math.floor(Math.random()*l.length)]}function d(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function u(e){let t=Math.floor(e/60),a=Math.floor(e%60),r=Math.floor(e%1*100);return`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}.${r.toString().padStart(2,"0")}`}function p(e,t,a=0){let r=e.getChannelData(a),s=Math.floor(r.length/t),i=[];for(let e=0;e<t;e++){let t=e*s,a=Math.min(t+s,r.length),l=0;for(let e=t;e<a;e++){let t=Math.abs(r[e]);t>l&&(l=t)}i.push(l)}return i}function m(e){return e?.length===0?16:Math.max(Math.max(...(e||[]).flatMap(e=>e.clipIds.map(e=>e.startTime+e.duration))),16)}async function h(e,t=1e3){try{let a=new OfflineAudioContext(1,e.length,e.sampleRate),r=a.createBufferSource();r.buffer=e,r.connect(a.destination),r.start(0);let s=await a.startRendering();return p(s,t,0)}catch(a){return console.error("Failed to generate waveform data offline:",a),p(e,t,0)}}class g{onMessage(e){let t=Math.random().toString(36);this.messageHandlers.set(t,e)}removeMessageHandler(e){this.messageHandlers.delete(e)}postMessage(e){setTimeout(()=>{this.messageHandlers.forEach(t=>t({data:e}))},0)}async processMessage(e){try{switch(e.type){case n.DECODE_AUDIO:{let{id:t,arrayBuffer:a,fileName:r}=e;try{let e=new OfflineAudioContext(2,44100,44100),s=await e.decodeAudioData(a.slice(0));this.postMessage({type:n.AUDIO_DECODED,id:t,audioBuffer:s,fileName:r,duration:s.duration,sampleRate:s.sampleRate})}catch(e){console.error("Audio decoding failed:",e),this.postMessage({type:n.DECODE_ERROR,id:t,error:e instanceof Error?e.message:"Unknown decoding error"})}break}case n.GENERATE_WAVEFORM:{let{id:t,audioBuffer:a,samples:r}=e;try{let e=await h(a,r);this.postMessage({type:n.WAVEFORM_GENERATED,id:t,waveformData:e})}catch(e){console.error("Waveform generation failed:",e),this.postMessage({type:n.DECODE_ERROR,id:t,error:e instanceof Error?e.message:"Waveform generation failed"})}break}default:console.warn("Unknown message type:",e.type)}}catch(t){console.error("Audio decoder error:",t),this.postMessage({type:n.DECODE_ERROR,id:e.id||"unknown",error:t instanceof Error?t.message:"Audio decoder processing error"})}}terminate(){this.messageHandlers.clear()}constructor(){this.messageHandlers=new Map}}let f=new g,x={project:{id:d(),name:"New Project",tracks:[],bpm:120,timeSignature:{numerator:4,denominator:4},duration:16},clips:[],audioEngine:{isPlaying:!1,currentSamples:0,isLooping:!1,loopStartSamples:0,loopEndSamples:705600,volume:.8,sampleRate:44100,isInitialized:!1},ui:{selectedClipId:null,pixelsPerSecond:50,isProcessing:!1,dragState:{isDragging:!1,dragType:null,hoveredTrackId:null,showNewTrackPlaceholder:!1,placeholderClip:null}},fileProcessing:[]};function v(e,t){switch(t.type){case"INITIALIZE_AUDIO_CONTEXT":return{...e,audioEngine:{...e.audioEngine,isInitialized:!0,sampleRate:t.sampleRate}};case"SET_PLAYING":return{...e,audioEngine:{...e.audioEngine,isPlaying:t.isPlaying}};case"SET_CURRENT_SAMPLES":return{...e,audioEngine:{...e.audioEngine,currentSamples:t.samples}};case"SET_LOOPING":return{...e,audioEngine:{...e.audioEngine,isLooping:t.isLooping}};case"SET_VOLUME":return{...e,audioEngine:{...e.audioEngine,volume:t.volume}};case"SET_PIXELS_PER_SECOND":return{...e,ui:{...e.ui,pixelsPerSecond:Math.max(4,Math.min(400,t.pixelsPerSecond))}};case"SELECT_CLIP":return{...e,ui:{...e.ui,selectedClipId:t.clipId}};case"SET_PROCESSING":return{...e,ui:{...e.ui,isProcessing:t.isProcessing}};case"ADD_PROCESSING_FILES":return{...e,fileProcessing:[...e.fileProcessing,...t.files]};case"UPDATE_PROCESSING_FILE":return{...e,fileProcessing:e.fileProcessing.map(e=>e.id===t.id?{...e,...t.updates}:e)};case"REMOVE_PROCESSING_FILE":return{...e,fileProcessing:e.fileProcessing.filter(e=>e.id!==t.id)};case"ADD_CLIP":return{...e,clips:[...e.clips,t.clip]};case"ADD_TRACK":{let a=t.track||{id:d(),name:`Track ${e.project.tracks.length+1}`,color:c(),volume:.8,pan:0,muted:!1,solo:!1,clipIds:[],index:e.project.tracks.length},r=[...e.project.tracks,a],s=m(r.map(t=>({...t,clips:t.clipIds.map(t=>e.clips.find(e=>e.id===t)).filter(Boolean)})));return{...e,project:{...e.project,tracks:r,duration:s}}}case"ASSIGN_CLIP_TO_TRACK":{let a=e.project.tracks.map(e=>e.id===t.trackId?{...e,clipIds:[...e.clipIds,t.clipId]}:e),r=m(a.map(t=>({...t,clips:t.clipIds.map(t=>e.clips.find(e=>e.id===t)).filter(Boolean)})));return{...e,project:{...e.project,tracks:a,duration:r}}}case"UPDATE_TRACK":return{...e,project:{...e.project,tracks:e.project.tracks.map(e=>e.id===t.trackId?{...e,...t.updates}:e)}};case"UPDATE_CLIP":{let a=e.clips.map(e=>e.id===t.clipId?{...e,...t.updates}:e),r=m(e.project.tracks.map(e=>({...e,clips:e.clipIds.map(e=>a.find(t=>t.id===e)).filter(Boolean)})));return{...e,clips:a,project:{...e.project,duration:r}}}case"UPDATE_CLIP_WAVEFORM":return{...e,clips:e.clips.map(e=>e.id===t.clipId?{...e,waveformData:t.waveformData}:e)};case"SET_DRAG_STATE":return{...e,ui:{...e.ui,dragState:{...e.ui.dragState,...t.dragState}}};case"RESET_DRAG_STATE":return{...e,ui:{...e.ui,dragState:{isDragging:!1,dragType:null,hoveredTrackId:null,showNewTrackPlaceholder:!1,placeholderClip:null}}};case"REMOVE_TRACK":{let a=e.project.tracks.find(e=>e.id===t.trackId);if(!a)return e;let r=e.project.tracks.filter(e=>e.id!==t.trackId),s=e.clips.filter(e=>!a.clipIds.includes(e.id)),i=m(r.map(e=>({...e,clips:e.clipIds.map(e=>s.find(t=>t.id===e)).filter(Boolean)})));return{...e,clips:s,project:{...e.project,tracks:r,duration:i}}}case"MOVE_CLIP_TO_TRACK":{let a=e.project.tracks.map(e=>e.clipIds.includes(t.clipId)?{...e,clipIds:e.clipIds.filter(e=>e!==t.clipId)}:e.id===t.targetTrackId?{...e,clipIds:[...e.clipIds,t.clipId]}:e),r=e.clips.map(e=>e.id===t.clipId?{...e,trackId:t.targetTrackId,startTime:t.newStartTime}:e),s=m(a.map(e=>({...e,clips:e.clipIds.map(e=>r.find(t=>t.id===e)).filter(Boolean)})));return{...e,clips:r,project:{...e.project,tracks:a,duration:s}}}default:return e}}let k=(0,s.createContext)(null);function E({children:e}){let[t,a]=(0,s.useReducer)(v,x),i=(0,s.useRef)(null),l=(0,s.useRef)(null);(0,s.useCallback)(e=>{a({type:"SET_CURRENT_SAMPLES",samples:e})},[a]),(0,s.useCallback)(e=>{a({type:"INITIALIZE_AUDIO_CONTEXT",sampleRate:e})},[a]);let u=(0,s.useCallback)(async()=>i.current?await i.current.resumeAudioContext():(console.warn("AudioEngine not initialized yet."),!1),[]);(0,s.useCallback)(async()=>{i.current&&await i.current.startPlayback()},[]),(0,s.useCallback)(()=>{i.current?.stopPlayback()},[]);let p=(0,s.useCallback)(e=>i.current?i.current.samplesToSeconds(e):0,[]),m=(0,s.useCallback)(e=>i.current?i.current.secondsToSamples(e):0,[]),h=(e,t="")=>{let r=[...e].filter(o);if(0===r.length)return;a({type:"SET_PROCESSING",isProcessing:!0});let s=r.map(e=>({id:d(),fileName:e.name,status:"processing"}));a({type:"ADD_PROCESSING_FILES",files:s}),f.onMessage(e=>{let t=e.data;switch(t.type){case n.AUDIO_DECODED:t.audioBuffer&&t.fileName&&t.duration&&g(t.id,t.audioBuffer,t.fileName,t.duration,t.trackId);break;case n.DECODE_ERROR:t.error&&E(t.id,t.error);break;case n.WAVEFORM_GENERATED:t.waveformData&&y(t.id,t.waveformData)}}),r.forEach((e,a)=>{let r=s[a].id,i=new FileReader;i.onload=a=>{let s=a.target?.result;s&&f.processMessage({type:n.DECODE_AUDIO,id:r,arrayBuffer:s,fileName:e.name,trackId:t})},i.readAsArrayBuffer(e)})},g=(0,s.useCallback)((e,r,s,i,l)=>{a({type:"UPDATE_PROCESSING_FILE",id:e,updates:{status:"completed"}});let o=d(),u={id:o,name:function(e,t=50){return e.replace(/[^a-zA-Z0-9._-]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"").substring(0,t)}(s.replace(/\.[^/.]+$/,"")),trackId:"",audioBuffer:r,waveformData:[],startTime:0,duration:i,volume:1,pitch:0,color:c(),isLoading:!1};a({type:"ADD_CLIP",clip:u});let p=t.ui.dragState,m=l||p.hoveredTrackId||"";m?a({type:"ASSIGN_CLIP_TO_TRACK",clipId:o,trackId:m}):a({type:"ADD_TRACK",track:{id:m=d(),name:`Track ${t.project.tracks.length+1}`,color:u.color,volume:.8,pan:0,muted:!1,solo:!1,clipIds:[o],index:t.project.tracks.length}}),a({type:"UPDATE_CLIP",clipId:o,updates:{trackId:m}}),f.processMessage({type:n.GENERATE_WAVEFORM,id:o,audioBuffer:r,samples:Math.min(1e3,Math.floor(100*i))}),a({type:"RESET_DRAG_STATE"}),setTimeout(()=>{a({type:"REMOVE_PROCESSING_FILE",id:e}),t.fileProcessing.length<=1&&a({type:"SET_PROCESSING",isProcessing:!1})},1e3)},[t.project.tracks.length,t.fileProcessing.length,t.ui.dragState,a]),E=(0,s.useCallback)((e,r)=>{console.error("Audio decode error:",r),a({type:"UPDATE_PROCESSING_FILE",id:e,updates:{status:"error",error:r}}),setTimeout(()=>{a({type:"REMOVE_PROCESSING_FILE",id:e}),t.fileProcessing.length<=1&&a({type:"SET_PROCESSING",isProcessing:!1})},3e3)},[t.fileProcessing.length,a]),y=(0,s.useCallback)((e,t)=>{a({type:"UPDATE_CLIP_WAVEFORM",clipId:e,waveformData:t})},[a]),b=(0,s.useCallback)(()=>{l.current?.click()},[]),j=(0,s.useCallback)(e=>{let t=Array.from(e.target.files||[]);t.length>0&&(h(t),e.target.value="")},[h]);return(0,r.jsxs)(k.Provider,{value:{state:t,dispatch:a,resumeAudioContext:u,samplesToSeconds:p,secondsToSamples:m,openFileDialog:b,handleFilesSelected:h},children:[e,(0,r.jsx)("input",{type:"file",accept:"audio/*,.wav,.mp3,.m4a,.mp4,.ogg,.flac",ref:l,multiple:!0,style:{display:"none"},onChange:j})]})}let y=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),b=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var j={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let C=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:i="",children:l,iconNode:n,...o},c)=>(0,s.createElement)("svg",{ref:c,...j,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:b("lucide",i),...o},[...n.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(l)?l:[l]])),P=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...r},i)=>(0,s.createElement)(C,{ref:i,iconNode:t,className:b(`lucide-${y(e)}`,a),...r}));return a.displayName=`${e}`,a},S=P("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),T=P("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);function _({duration:e,currentTime:t,pixelsPerSecond:a,bpm:i,timeSignature:l,height:n=48,isCollapsed:o=!1,onScrub:c,onZoomChange:d,onToggleCollapse:p}){let m=(0,s.useRef)(null),h=(0,s.useRef)(!1),[g,f]=(0,s.useState)(0),x=e*a,v=(0,s.useMemo)(()=>{let t=1/a,r=1,s=.25;t>.5?(r=10,s=2):t>.1?(r=5,s=1):t>.02&&(r=2,s=.5);let n=[],o=[];for(let t=0;t<=e;t+=s){let e=t*a,s=t%r==0;n.push({x:e,time:t,isMajor:s,label:s&&e>0?u(t):null})}if(a>20){let t=i/60,r=l.numerator,s=1/t,n=s*r;for(let t=0;t<=e;t+=s){let e=t*a,r=t%n<.001;o.push({x:e,isBarStart:r})}}return{timeMarkers:n,beatMarkers:o}},[e,a,i,l]),k=(0,s.useCallback)(t=>{if(!m.current)return;let r=m.current.getBoundingClientRect(),s=Math.max(0,Math.min((t.clientX-r.left)/a,e));h.current=!0,c(s);let i=t=>{if(!h.current||!m.current)return;let r=m.current.getBoundingClientRect();c(Math.max(0,Math.min((t.clientX-r.left)/a,e)))},l=()=>{h.current=!1,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",l)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",l)},[a,e,c]),E=(0,s.useCallback)(e=>{console.log(e),e.preventDefault(),d(Math.max(10,Math.min(200,a*(e.deltaY>0?.9803921568627451:1.02))))},[a,d]),y=t*a,b=(0,s.useCallback)(()=>d(.8*a),[a]),j=(0,s.useCallback)(()=>d(1.125*a),[a]),C=(0,s.useMemo)(()=>Math.round(a),[a]);return(0,r.jsxs)("div",{className:`timeline-container ${h.current?"scrubbing":""} ${o?"collapsed":""}`,style:{width:g},children:[(0,r.jsxs)("div",{ref:m,className:"timeline-svg-container",onMouseDown:k,onWheel:E,style:{width:g},children:[(0,r.jsxs)("svg",{className:"timeline-svg",width:g,height:n,viewBox:`0 0 ${g} ${n}`,role:"img","aria-label":`Timeline showing ${u(e)} duration, current time ${u(t)}`,children:[(0,r.jsx)("rect",{width:x,height:n,fill:"#222222"}),v.beatMarkers.map((e,t)=>(0,r.jsx)("line",{x1:e.x,y1:0,x2:e.x,y2:e.isBarStart?15:8,stroke:e.isBarStart?"#ff5500":"#ffbe0b",strokeWidth:e.isBarStart?2:1},`beat-${t}`)),v.timeMarkers.map((e,t)=>(0,r.jsxs)("g",{children:[(0,r.jsx)("line",{x1:e.x,y1:n-(e.isMajor?20:10),x2:e.x,y2:n,stroke:e.isMajor?"#666666":"#444444",strokeWidth:1}),e.label&&(0,r.jsx)("text",{x:e.x+2,y:n-32,fill:"#aaaaaa",fontSize:"10",fontFamily:"system-ui",dominantBaseline:"hanging",children:e.label})]},`time-${t}`))]}),(0,r.jsxs)("div",{className:"playhead",style:{transform:`translateX(${y}px)`,height:`${n}px`},children:[(0,r.jsx)("div",{className:"playhead-handle"}),(0,r.jsx)("div",{className:"playhead-line"})]})]}),(0,r.jsxs)("div",{className:`timeline-controls ${o?"collapsed":""}`,children:[(0,r.jsx)("button",{className:"collapse-button",onClick:p,title:o?"Expand controls":"Collapse controls",children:o?(0,r.jsx)(S,{size:16}):(0,r.jsx)(T,{size:16})}),!o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"zoom-button",onClick:b,title:"Zoom out",children:"-"}),(0,r.jsxs)("span",{className:"zoom-level",children:[C,"px/s"]}),(0,r.jsx)("button",{className:"zoom-button",onClick:j,title:"Zoom in",children:"+"})]})]})]})}a(2558);let N=function({waveformData:e,width:t,height:a,color:i="currentColor",backgroundColor:l="transparent",strokeWidth:n=.5,className:o}){let c=(0,s.useMemo)(()=>{if(!e.length)return"";let r=a/2,s=a/2-2,i=[],l=[];for(let a=0;a<e.length;a++){let n=a/(e.length-1)*t,o=e[a]*s,c=r-o,d=r+o;0===a?(i.push(`M ${n} ${c}`),l.push(`M ${n} ${d}`)):(i.push(`L ${n} ${c}`),l.push(`L ${n} ${d}`))}return[...i,...l.reverse(),"Z"].join(" ")},[e,t,a]),d=(0,s.useMemo)(()=>{if(!e.length)return"";let r=a/2,s=a/2-2,i=[],l=[];for(let a=0;a<e.length;a++){let n=a/(e.length-1)*t,o=e[a]*s,c=r-o,d=r+o;0===a?(i.push(`M ${n} ${c}`),l.push(`M ${n} ${d}`)):(i.push(`L ${n} ${c}`),l.push(`L ${n} ${d}`))}return[i.join(" "),l.join(" ")].join(" ")},[e,t,a]);return e.length?(0,r.jsxs)("svg",{style:{color:i},className:`audio-waveform ${o}`,width:t,height:a,role:"img","aria-label":"Audio waveform visualization",children:[(0,r.jsx)("rect",{className:"background",width:t,height:a,fill:l}),(0,r.jsx)("path",{className:"fill",d:c,fill:i}),(0,r.jsx)("path",{className:"stroke",d:d,stroke:i})]}):(0,r.jsx)("svg",{style:{color:i},className:`audio-waveform ${o}`,width:t,height:a,role:"img","aria-label":"Empty audio waveform",children:(0,r.jsx)("rect",{className:"background",width:t,height:a})})};a(9228);let A=({onMove:e,onResize:t,onMoveToTrack:a})=>{let r=(0,s.useRef)(null),i=(0,s.useRef)({width:null,action:null,x:null,y:null}),l=()=>{let e=r.current?.getBoundingClientRect();return{x:e?.x,y:e?.y,width:e?.width,time:Date.now()}},n=e=>{let t=e.clientX-i.current.startX,a=e.clientY-i.current.startY;r.current&&(r.current.style.transform=`translate(${t}px, ${a}px)`)},o=()=>{i.current.x=null,i.current.y=null,i.current.width=null,i.current.action=null,document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o),r.current&&(r.current.style.transform="translate(0, 0)"),l()};return r},D=function({clip:e,pixelsPerSecond:t,sampleRate:a,trackHeight:i,isSelected:l=!1,onSelect:n,onMove:o,onResize:c,onMoveToTrack:d}){let p=A({onMove:o,onResize:c,onMoveToTrack:d}),m=t/a,h=e.duration*m,g=(0,s.useMemo)(()=>i-4,[i]),f=(0,s.useCallback)(t=>{t.stopPropagation(),n?.(e.id)},[e.id,n]);return(0,r.jsx)("div",{ref:p,className:"audio-clip",style:{height:`${g}px`,width:`${h/m}px`,left:`${e.startTime*t}px`,backgroundColor:`${e.color}40`||"#3a86ff40",borderColor:l?`${e.color}a0`:"transparent"},onClick:f,title:`${e.name} - ${u(e.duration)}`,children:e.isLoading?(0,r.jsxs)("div",{className:"clip-loading",children:[(0,r.jsx)("div",{className:"loading-spinner"}),(0,r.jsx)("span",{children:"Processing..."})]}):(0,r.jsxs)(r.Fragment,{children:[e.waveformData.length>0&&(0,r.jsx)(N,{waveformData:e.waveformData,height:g,color:e.color,className:"clip-waveform"}),(0,r.jsxs)("div",{className:"clip-label",children:[(0,r.jsx)("span",{className:"clip-name",children:e.name}),(0,r.jsx)("span",{className:"clip-time",children:u(e.duration)})]}),(0,r.jsx)("div",{className:"resize-handle"})]})})},M=P("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),w=P("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),I=P("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),R=P("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),L=P("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);a(6262);let O=function({track:e,pixelsPerSecond:t,trackHeight:a,projectDuration:i,selectedClipId:l,isCollapsed:n=!1,onTrackUpdate:o,onClipSelect:c,onClipMove:d,onClipResize:u,onClipMoveToTrack:p,onTrackRemove:m,onFileUpload:h,onTrackHover:g,isHovered:f=!1,showPlaceholder:x=!1}){let v=(0,s.useCallback)(t=>{let a=parseFloat(t.target.value);o(e.id,{volume:a})},[e.id,o]),k=(0,s.useCallback)(t=>{let a=parseFloat(t.target.value);o(e.id,{pan:a})},[e.id,o]),E=(0,s.useCallback)(()=>{o(e.id,{muted:!e.muted})},[e.id,e.muted,o]),y=(0,s.useCallback)(()=>{o(e.id,{solo:!e.solo})},[e.id,e.solo,o]),b=(0,s.useCallback)(t=>{o(e.id,{name:t.target.value})},[e.id,o]),j=(0,s.useCallback)(()=>{window.confirm(`Are you sure you want to remove the track "${e.name}"?`)&&m?.(e.id)},[e.id,e.name,m]),C=i*t,P=(0,s.useCallback)(()=>{x&&g?.(e.id)},[x,g,e.id]),S=(0,s.useCallback)(()=>{x&&g?.(null)},[x,g]);return(0,r.jsxs)("div",{className:`audio-track ${f?"hovered":""} ${x?"drag-target":""}`,"data-track-id":e.id,onMouseEnter:P,onMouseLeave:S,children:[(0,r.jsxs)("header",{className:`track-header ${n?"collapsed":""}`,children:[(0,r.jsx)("input",{type:"text",value:e.name,onChange:b,className:"track-name-input",style:{color:e.color}}),(0,r.jsxs)("div",{className:"track-controls",children:[(0,r.jsx)("button",{className:`track-button mute-button ${e.muted?"active":""}`,onClick:E,title:e.muted?"Unmute":"Mute",children:e.muted?(0,r.jsx)(M,{size:14}):(0,r.jsx)(w,{size:14})}),(0,r.jsx)("button",{className:`track-button solo-button ${e.solo?"active":""}`,onClick:y,title:e.solo?"Unsolo":"Solo",children:(0,r.jsx)(I,{size:14})}),(0,r.jsx)("button",{className:"track-button remove-button",onClick:j,title:"Remove track",children:(0,r.jsx)(R,{size:14})}),(0,r.jsxs)("label",{className:"slider-container",children:[(0,r.jsx)("span",{className:"slider-label",children:"Vol"}),(0,r.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:e.volume,onChange:v,className:"volume-slider",title:`Volume: ${Math.round(100*e.volume)}%`}),(0,r.jsx)("output",{className:"slider-value",children:Math.round(100*e.volume)})]}),(0,r.jsxs)("label",{className:"slider-container",children:[(0,r.jsx)("span",{className:"slider-label",children:"Pan"}),(0,r.jsx)("input",{type:"range",min:"-1",max:"1",step:"0.01",value:e.pan,onChange:k,className:"pan-slider",title:`Pan: ${e.pan>0?"R":e.pan<0?"L":"C"}${Math.abs(Math.round(100*e.pan))}`}),(0,r.jsx)("output",{className:"slider-value",children:0===e.pan?"C":`${e.pan>0?"R":"L"}${Math.abs(Math.round(100*e.pan))}`})]})]})]}),(0,r.jsxs)("div",{className:"track-content",style:{width:C},children:[(0,r.jsx)("div",{className:"track-lane",style:{width:C,height:a,borderLeft:`3px solid ${e.color}`}}),e.clipIds.map(e=>(0,r.jsx)(D,{clip:e,pixelsPerSecond:t,trackHeight:a,isSelected:l===e.id,onSelect:c,onMove:d,onResize:u,onMoveToTrack:p},e.id)),0===e.clipIds.length&&!f&&(0,r.jsxs)("div",{className:"empty-track-upload",children:[(0,r.jsx)("label",{className:"upload-button btn-primary",htmlFor:`file-upload-${e.id}`,children:(0,r.jsx)(L,{size:16})}),(0,r.jsx)("input",{id:`file-upload-${e.id}`,type:"file",accept:"audio/*",multiple:!0,onChange:t=>{let a=t.target.files;a&&h&&(h(a,e.id),t.target.value="")},style:{display:"none"}})]}),f&&x&&(0,r.jsx)("div",{className:"clip-placeholder",children:(0,r.jsx)("div",{className:"placeholder-content",children:(0,r.jsx)("span",{children:"Drop audio file here"})})})]})]})},$=P("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),U=P("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),G=P("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),z=P("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);a(2799);let F=function({isPlaying:e,currentTime:t,bpm:a,timeSignature:i,volume:l,isLooping:n,onPlay:o,onPause:c,onStop:d,onVolumeChange:p,onLoopToggle:m,onUserGesture:h}){let g=(0,s.useCallback)(e=>{p(parseFloat(e.target.value))},[p]),f=(0,s.useCallback)(()=>{h?.(),o()},[o,h]);return(0,r.jsxs)("div",{className:"playback-controls",children:[(0,r.jsxs)("div",{className:"transport-buttons",children:[(0,r.jsx)("button",{className:`transport-button play-pause ${e?"playing":""}`,onClick:e?c:f,title:e?"Pause":"Play",children:e?(0,r.jsx)($,{size:20}):(0,r.jsx)(U,{size:20})}),(0,r.jsx)("button",{className:"transport-button stop",onClick:d,title:"Stop",children:(0,r.jsx)(G,{size:18})}),(0,r.jsx)("button",{className:`transport-button loop ${n?"active":""}`,onClick:m,title:n?"Disable Loop":"Enable Loop",children:(0,r.jsx)(z,{size:18})})]}),(0,r.jsxs)("div",{className:"time-display",children:[(0,r.jsxs)("div",{className:"time-format",children:[(0,r.jsx)("span",{className:"time-value",children:u(t)}),(0,r.jsx)("span",{className:"time-label",children:"Time"})]}),(0,r.jsxs)("div",{className:"time-format",children:[(0,r.jsx)("span",{className:"time-value",children:function(e,t,a){let r=t/60*e,s=a.numerator,i=Math.floor(r/s)+1,l=r%s,n=Math.floor(l)+1,o=Math.floor((l-Math.floor(l))*4)+1;return`${i}.${n}.${o}`}(t,a,i)}),(0,r.jsx)("span",{className:"time-label",children:"Bars"})]})]}),(0,r.jsxs)("div",{className:"bpm-display",children:[(0,r.jsx)("span",{className:"bpm-value",children:a}),(0,r.jsx)("span",{className:"bpm-label",children:"BPM"})]}),(0,r.jsxs)("div",{className:"master-volume",children:[(0,r.jsx)(w,{size:16,className:"volume-icon"}),(0,r.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:l,onChange:g,className:"master-volume-slider",title:`Master Volume: ${Math.round(100*l)}%`}),(0,r.jsxs)("span",{className:"volume-value",children:[Math.round(100*l),"%"]})]})]})},V=P("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a(8955),a(9397);let W=function(){let{state:e,dispatch:t,resumeAudioContext:a,samplesToSeconds:i,secondsToSamples:l,handleFilesSelected:n}=function(){let e=(0,s.useContext)(k);if(!e)throw Error("useAudioEngine must be used within an AudioEngineProvider");return e}(),c=(0,s.useRef)(null),[d,u]=(0,s.useState)(!1),p=(0,s.useCallback)(()=>{t({type:"SET_PLAYING",isPlaying:!0})},[t]),h=(0,s.useCallback)(()=>{t({type:"SET_PLAYING",isPlaying:!1})},[t]),g=(0,s.useCallback)(()=>{t({type:"SET_PLAYING",isPlaying:!1}),t({type:"SET_CURRENT_SAMPLES",samples:0})},[t]);(0,s.useCallback)(()=>{e.audioEngine.isPlaying?h():p()},[e.audioEngine.isPlaying,p,h]),(0,s.useCallback)(()=>{t({type:"SET_CURRENT_SAMPLES",samples:0}),e.audioEngine.isPlaying||p()},[t,e.audioEngine.isPlaying,p]);let f=(0,s.useCallback)(async()=>{console.log("User gesture detected - resuming AudioContext"),await a()?console.log("AudioContext successfully resumed"):console.warn("Failed to resume AudioContext")},[a]),x=(0,s.useCallback)(e=>{t({type:"SET_CURRENT_SAMPLES",samples:l(e)})},[l,t]),v=(0,s.useCallback)(e=>{t({type:"SET_VOLUME",volume:e})},[t]),E=(0,s.useCallback)(()=>{t({type:"SET_LOOPING",isLooping:!e.audioEngine.isLooping})},[t,e.audioEngine.isLooping]),y=(0,s.useCallback)((e,a)=>{t({type:"UPDATE_TRACK",trackId:e,updates:a})},[t]),b=(0,s.useCallback)(e=>{t({type:"SELECT_CLIP",clipId:e})},[t]),j=(0,s.useCallback)((e,a)=>{t({type:"UPDATE_CLIP",clipId:e,updates:{startTime:Math.max(0,a)}})},[t]),C=(0,s.useCallback)((e,a)=>{t({type:"UPDATE_CLIP",clipId:e,updates:{duration:Math.max(.1,a)}})},[t]),P=(0,s.useCallback)(e=>{t({type:"SET_PIXELS_PER_SECOND",pixelsPerSecond:e})},[t]),S=(0,s.useCallback)(()=>{t({type:"ADD_TRACK"})},[t]),T=(0,s.useCallback)((e,a,r)=>{t({type:"MOVE_CLIP_TO_TRACK",clipId:e,targetTrackId:a,newStartTime:r})},[t]),N=(0,s.useCallback)(t=>{let a=e.project.tracks.find(e=>e.id===t);return a?a.clipIds.map(t=>e.clips.find(e=>e.id===t)).filter(Boolean):[]},[e.project.tracks,e.clips]);(0,s.useCallback)(()=>e.ui.selectedClipId&&e.clips.find(t=>t.id===e.ui.selectedClipId)||null,[e.ui.selectedClipId,e.clips]);let{dragProps:A}=function({onFilesDropped:e,onDragEnter:t,onDragLeave:a,onDragOver:r}){let i=(0,s.useRef)({isDragOver:!1,dragType:null,hoveredElement:null}),l=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),Array.from(e.dataTransfer.types).includes("Files")&&(i.current={isDragOver:!0,dragType:"file",hoveredElement:e.currentTarget},t?.(i.current))},[t]),n=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation();let t=e.relatedTarget;e.currentTarget.contains(t)||(i.current={isDragOver:!1,dragType:null,hoveredElement:null},a?.(i.current))},[a]);return{dragProps:{onDragEnter:l,onDragLeave:n,onDragOver:(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),r?.(i.current)},[r]),onDrop:(0,s.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),i.current={isDragOver:!1,dragType:null,hoveredElement:null};let r=Array.from(t.dataTransfer.files).filter(o);r.length>0&&e(r),a?.(i.current)},[e,a])},isDragOver:i.current.isDragOver}}({onFilesDropped:n,onDragEnter:()=>{t({type:"SET_DRAG_STATE",dragState:{isDragging:!0,dragType:"file"}})},onDragLeave:()=>{t({type:"RESET_DRAG_STATE"})}}),M=(0,s.useMemo)(()=>isNaN(e.project.duration)?m(e.project.tracks):e.project.duration||16,[e]),w=(0,s.useCallback)(a=>{e.ui.dragState.isDragging&&"file"===e.ui.dragState.dragType&&t({type:"SET_DRAG_STATE",dragState:{hoveredTrackId:a}})},[t,e.ui.dragState]),I=i(e.audioEngine.currentSamples),R=e.ui.pixelsPerSecond;return(0,r.jsxs)("div",{className:"main-audio-view",children:[c.current?.enabled&&(0,r.jsx)("div",{className:"hotkeys-indicator",title:"Keyboard shortcuts are active",children:"\uD83C\uDFB9"}),(0,r.jsx)(F,{isPlaying:e.audioEngine.isPlaying,currentTime:I,bpm:e.project.bpm,timeSignature:e.project.timeSignature,volume:e.audioEngine.volume,isLooping:e.audioEngine.isLooping,onPlay:p,onPause:h,onStop:g,onVolumeChange:v,onLoopToggle:E,onUserGesture:f}),(0,r.jsx)("div",{className:"audio-workspace",children:(0,r.jsxs)("div",{className:"tracks-area",...A,children:[(0,r.jsx)(_,{duration:M,currentTime:I,pixelsPerSecond:e.ui.pixelsPerSecond,bpm:e.project.bpm,timeSignature:e.project.timeSignature,isCollapsed:d,onScrub:x,onZoomChange:P,onToggleCollapse:()=>u(e=>!e)}),(0,r.jsxs)("div",{className:"tracks-container",children:[0===e.project.tracks.length&&(0,r.jsxs)("div",{className:"empty-tracks-message",children:[(0,r.jsx)("p",{children:"Drop audio files here to get started"}),(0,r.jsx)("p",{className:"empty-tracks-subtitle",children:"or create a track manually"}),(0,r.jsxs)("button",{className:"btn-primary add-track-button-empty",onClick:S,title:"Add new audio track",children:[(0,r.jsx)(V,{size:16}),"Add Track"]})]}),e.project.tracks.flatMap(e=>N(e.id)).map(e=>(0,r.jsx)(D,{clip:e,pixelsPerSecond:R,trackHeight:64},e.id)),e.project.tracks.map(a=>(0,r.jsx)(O,{track:{...a},pixelsPerSecond:e.ui.pixelsPerSecond,trackHeight:64,projectDuration:M,selectedClipId:e.ui.selectedClipId,isCollapsed:d,onTrackUpdate:y,onClipSelect:b,onClipMove:j,onClipResize:C,onClipMoveToTrack:T,onTrackRemove:e=>t({type:"REMOVE_TRACK",trackId:e}),onFileUpload:n,onTrackHover:w,isHovered:e.ui.dragState.hoveredTrackId===a.id,showPlaceholder:e.ui.dragState.isDragging&&"file"===e.ui.dragState.dragType},a.id)),e.ui.dragState.isDragging&&"file"===e.ui.dragState.dragType&&!e.ui.dragState.hoveredTrackId&&(0,r.jsx)("div",{className:"new-track-placeholder",children:(0,r.jsx)("div",{className:"placeholder-content",children:(0,r.jsx)("span",{children:"Drop here to create new track"})})}),(0,r.jsx)("div",{className:"add-track-container",children:(0,r.jsxs)("button",{className:"btn-primary add-track-button",onClick:S,title:"Add new audio track",children:[(0,r.jsx)(V,{size:16}),"Add Track"]})})]})]})})]})},B=function(){return(0,s.useCallback)(()=>{let e=e=>{e.preventDefault()};(0,s.useEffect)(()=>(document.addEventListener("wheel",e,{passive:!1,capture:!1}),()=>{document.removeEventListener("wheel",e)}),[])},[])(),(0,r.jsxs)("div",{className:"app",children:[(0,r.jsxs)("header",{className:"app-header",children:[(0,r.jsx)("h1",{children:"audioblocks"}),(0,r.jsx)("p",{children:"audio-streams"})]}),(0,r.jsx)("main",{className:"app-main",children:(0,r.jsx)(E,{children:(0,r.jsx)(W,{})})})]})}},2558:()=>{},2799:()=>{},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},6262:()=>{},7155:(e,t,a)=>{Promise.resolve().then(a.bind(a,1187))},7618:()=>{},8004:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,6444,23)),Promise.resolve().then(a.t.bind(a,6042,23)),Promise.resolve().then(a.t.bind(a,8170,23)),Promise.resolve().then(a.t.bind(a,9477,23)),Promise.resolve().then(a.t.bind(a,9345,23)),Promise.resolve().then(a.t.bind(a,2089,23)),Promise.resolve().then(a.t.bind(a,6577,23)),Promise.resolve().then(a.t.bind(a,1307,23))},8014:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n,metadata:()=>l});var r=a(7413),s=a(9258),i=a.n(s);a(7618);let l={title:"Audio Streams - Web DAW Module",description:"Web-based audio streaming and DAW module with drag-and-drop support and Web Worker-powered audio processing.",keywords:["audio","daw","web-audio","streaming","music","react","nextjs"],authors:[{name:"Audio Streams Team"}],creator:"Audio Streams Team",robots:{index:!0,follow:!0}};function n({children:e}){return(0,r.jsxs)("html",{lang:"en",children:[(0,r.jsxs)("head",{children:[(0,r.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:`
            /* Critical CSS for initial load */
            @layer base {
              body {
                margin: 0;
                padding: 0;
                font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
                background-color: #121212;
                color: #ffffff;
                overflow: hidden;
              }

              #root {
                height: 100vh;
                width: 100vw;
              }

              /* Loading spinner */
              .loading {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
              }

              .loading-spinner {
                width: 40px;
                height: 40px;
                border: 4px solid rgba(255, 85, 0, 0.2);
                border-radius: 50%;
                border-top-color: #ff5500;
                animation: spin 1s linear infinite;
              }

              @keyframes spin {
                to { transform: rotate(360deg); }
              }

              .loading-text {
                color: #aaaaaa;
                font-size: 14px;
              }
            }
          `}})]}),(0,r.jsx)("body",{className:i().className,suppressHydrationWarning:!0,children:e})]})}},8585:()=>{},8954:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=a(5239),s=a(8088),i=a(8170),l=a.n(i),n=a(893),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,597)),"/Users/tvndra/Documents/Projects/Audio/audioblocks/audio-streams/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,8014)),"/Users/tvndra/Documents/Projects/Audio/audioblocks/audio-streams/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,5284,23)),"next/dist/client/components/unauthorized-error"]}],d=["/Users/tvndra/Documents/Projects/Audio/audioblocks/audio-streams/app/page.tsx"],u={require:a,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8955:()=>{},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9228:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9397:()=>{},9444:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,6346,23)),Promise.resolve().then(a.t.bind(a,7924,23)),Promise.resolve().then(a.t.bind(a,5656,23)),Promise.resolve().then(a.t.bind(a,99,23)),Promise.resolve().then(a.t.bind(a,8243,23)),Promise.resolve().then(a.t.bind(a,8827,23)),Promise.resolve().then(a.t.bind(a,2763,23)),Promise.resolve().then(a.t.bind(a,7173,23))}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[744],()=>a(8954));module.exports=r})();